<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>New Challenger スケジュール</title>
<style>
  body {
    font-family: 'Arial', sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f9f9f9;
    color: #333;
  }
  header {
    background-color: #ff5555;
    color: white;
    text-align: center;
    padding: 12px 0;
    font-size: 1.5em;
    font-weight: bold;
  }
  section {
    margin: 16px;
  }
  h2 {
    font-size: 1.2em;
    margin-bottom: 8px;
  }
  .event-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  .event-item {
    background-color: white;
    margin-bottom: 8px;
    padding: 12px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 1em;
  }
  .event-item.upcoming {
    border-left: 5px solid #ff5555;
  }
  .event-time {
    font-weight: bold;
    margin-right: 8px;
  }
  .check {
    transform: scale(1.2);
    cursor: pointer;
  }
  @media(max-width:600px){
    .event-item { font-size: 0.9em; padding: 10px; }
    .event-time { margin-right: 6px; }
  }
</style>
</head>
<body>

<header>New Challenger スケジュール</header>

<section>
  <h2>今日のイベント</h2>
  <ul id="today" class="event-list"></ul>
</section>

<section>
  <h2>明日のイベント</h2>
  <ul id="tomorrow" class="event-list"></ul>
</section>

<section>
  <h2>明後日以降</h2>
  <div id="future"></div>
</section>

<script>
// --- データ --- 
const events = [
  {name:"VSリュウ 初級", times:["2025-10-05T12:00","2025-10-06T03:00","2025-10-11T18:00","2025-10-13T12:00","2025-10-17T00:00","2025-10-19T12:00","2025-10-20T03:00"]},
  {name:"VSリュウ 激ムズ", times:["2025-10-04T18:00","2025-10-06T12:00","2025-10-10T12:00","2025-10-12T00:00","2025-10-13T21:00","2025-10-18T18:00"]},
  {name:"VS春麗 初級", times:["2025-10-05T12:00","2025-10-07T12:00","2025-10-11T18:00","2025-10-14T21:00","2025-10-17T00:00","2025-10-19T12:00"]},
  {name:"VS春麗 激ムズ", times:["2025-10-04T18:00","2025-10-07T03:00","2025-10-10T12:00","2025-10-12T00:00","2025-10-14T06:00","2025-10-18T18:00"]}
  // 他のステージも同様に追加可能
];

// --- クリア済み管理 ---
// URLのクエリパラメータ ?cleared=VSリュウ+初級,VS春麗+初級
const urlParams = new URLSearchParams(window.location.search);
const cleared = urlParams.get("cleared") ? urlParams.get("cleared").split(",") : [];

// --- 現在日付 ---
const now = new Date();
const todayDate = now.toISOString().slice(0,10);

// --- 出力関数 ---
function addEvent(el, name, timeStr, isUpcoming) {
  const li = document.createElement("li");
  li.className = "event-item" + (isUpcoming ? " upcoming" : "");
  const eventTime = new Date(timeStr);
  li.innerHTML = `<span class="event-time">${eventTime.getHours().toString().padStart(2,'0')}:${eventTime.getMinutes().toString().padStart(2,'0')}</span> ${name} <input type="checkbox" class="check">`;
  const checkbox = li.querySelector(".check");
  checkbox.checked = cleared.includes(name);
  checkbox.addEventListener("change", ()=>updateURL(name, checkbox.checked));
  el.appendChild(li);
}

// URL更新
function updateURL(name, checked){
  let current = new URLSearchParams(window.location.search);
  let list = current.get("cleared") ? current.get("cleared").split(",") : [];
  if(checked && !list.includes(name)) list.push(name);
  if(!checked) list = list.filter(x=>x!==name);
  if(list.length>0) current.set("cleared", list.join(",")); else current.delete("cleared");
  window.history.replaceState({},'',window.location.pathname+'?'+current.toString());
}

// --- イベント分類 ---
const todayEl = document.getElementById("today");
const tomorrowEl = document.getElementById("tomorrow");
const futureEl = document.getElementById("future");

let futureMap = {}; // 日付ごとに整理

events.forEach(ev=>{
  if(cleared.includes(ev.name)) return; // クリア済みは非表示
  ev.times.forEach(t=>{
    const d = new Date(t);
    const dateStr = d.toISOString().slice(0,10);
    const diffDays = Math.floor((d - now)/(1000*60*60*24));
    if(diffDays===0) addEvent(todayEl, ev.name, t, true);
    else if(diffDays===1) addEvent(tomorrowEl, ev.name, t, true);
    else {
      if(!futureMap[dateStr]) futureMap[dateStr]=[];
      futureMap[dateStr].push({name:ev.name,time:t});
    }
  });
});

// 日付順・時間順で表示
Object.keys(futureMap).sort().forEach(date=>{
  const div = document.createElement("div");
  const title = document.createElement("h3");
  title.textContent = date;
  div.appendChild(title);
  const ul = document.createElement("ul");
  ul.className="event-list";
  futureMap[date].sort((a,b)=>new Date(a.time)-new Date(b.time)).forEach(ev=>{
    addEvent(ul, ev.name, ev.time, false);
  });
  div.appendChild(ul);
  futureEl.appendChild(div);
});
</script>

</body>
</html>


